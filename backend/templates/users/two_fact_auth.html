{% extends "base.html" %}
{% load static %}

{% block title %}2fa Setup{% endblock title %}

{% block nav %}
<a href="{% url 'home' %}" class="btn btn-secondary spa-link" data-method="GET">Back to home</a>
{% endblock nav %}

{% block content %}

<div class="container entry-form d-flex justify-content-center align-items-center flex-column">

    <h2>2fa Authenticator</h2>
    <p>Scan this QR code with Google Authenticator to set up your two-factor authentication:</p>

    <div>
        <img src="{{ user.qrcode_img.url }}" alt="">
    </div>
    <p>{{ user.username }}</p>
    
    <p>After generates the code, insert it here to complete your login.</p>

    {% if error %}
    <div class="alert alert-block alert-danger"> 
        <ul class="m-0"> 
            <li>{{error}}</li> 
        </ul> 
    </div>
    {% endif %}

    <form id="otp-form" data-redirect="{% url "home" %}" class="entry-form">
        {% csrf_token %}
        <label for="otp">OTP Code:</label>
        <input type="text" name="otp" id="otp" class="" required>
        <a class="btn btn-primary spa-link" href="{% url 'verify_otp' %}" data-method="POST" data-form="#otp-form">Log In</a>
    </form>

</div>
    

{% endblock content %}